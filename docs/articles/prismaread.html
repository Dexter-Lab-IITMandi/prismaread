<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>prismaread • prismaread</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="prismaread">
<meta property="og:description" content="prismaread">
<meta property="og:image" content="https://github.com/irea-cnr-mi/prismaread/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">prismaread</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>

  </a>
</li>
<li>
  <a href="../articles/prismaread.html">Get started</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/irea-cnr-mi/prismaread/">
    <span class="fab fa fab fa-github fa-lg"></span>

  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Importing-Level-1-Data.html">Importing Level 1 Data</a>
    </li>
    <li>
      <a href="../articles/Importing-Level-2-Data.html">Importing Level 2 Data</a>
    </li>
    <li>
      <a href="../articles/Computing-Spectral-Indexes.html">Computing Spectral Indexes</a>
    </li>
    <li>
      <a href="../articles/Output-Format-and-Naming.html">Output Format and Naming</a>
    </li>
    <li>
      <a href="../articles/Extracting-data-over-vector.html">Extracting Data Over Vector Features</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><script src="prismaread_files/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="prismaread_files/htmlwidgets-1.5.1/htmlwidgets.js"></script><script src="prismaread_files/jquery-1.12.4/jquery.min.js"></script><link href="prismaread_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="prismaread_files/datatables-binding-0.15/datatables.js"></script><link href="prismaread_files/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="prismaread_files/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="prismaread_files/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><link href="prismaread_files/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet">
<script src="prismaread_files/crosstalk-1.1.0.1/js/crosstalk.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>prismaread</h1>


      <small class="dont-index">Source: <a href="https://github.com/irea-cnr-mi/prismaread/blob/master/vignettes/prismaread.Rmd"><code>vignettes/prismaread.Rmd</code></a></small>
      <div class="hidden name"><code>prismaread.Rmd</code></div>

    </div>



<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://irea-cnr-mi.github.io/prismaread">prismaread</a></span>)
</pre></div>
<p><code>prismaread</code> allows easily importing PRISMA hyperspectral data (<a href="http://www.prisma-i.it/index.php/it/" class="uri">http://www.prisma-i.it/index.php/it/</a>) from the original data provided by ASI in HDF format, and convert them to a easier to use format (ENVI or GeoTiff). It also provides functionality for automatically computing Spectral Indexes from either the original HDF data or from hyperspectral data already converted using function <code>pr_convert</code>, and for easily and quickly extracting data and computing statistics for the different bands over areas of interest.</p>
<div id="importing-l1-data" class="section level1">
<h1 class="hasAnchor">
<a href="#importing-l1-data" class="anchor"></a>Importing L1 data</h1>
<p>The function to be used to import PRISMA L1 data is <code>pr_convert</code>. It takes as input the full path of a PRISMA L1 hdf5 image, an output folder name and format, and a series of switches allowing to decide which hyperspectral cubes and ancillary datasets should be crated.</p>
<p>In particular:</p>
<ul>
<li>the <code>VNIR</code> and <code>SWIR</code> logical arguments allow to decide if importing the VNIR and SWIR hyperspectral cubes;</li>
<li>the <code>FULL</code> logical argument <code>FULL</code> argument allows deciding if a complete VNIR+SWIR cube has to be created alongside the “single” VNIR and SWIR ones. In that case, the ‘join_priority’ keyword is used to decide if keeping bands from the “VNIR” or the “SWIR” data cube in the wavelength were they overlap.</li>
<li>the <code>PAN</code>, <code>LATLON</code>, <code>CLOUD</code>, <code>GLINT</code> and <code>LC</code> logical argument allow to decide which of the corresponding ancillary datasets should be created (see the PRISMA manual for additional info)</li>
</ul>
<p>A “base” georeferencing in Lat/Lon WGS-84 based on the “GLT and Bowtie Correction” technique used in ENVI, and described in <a href="https://www.harrisgeospatial.com/docs/backgroundgltbowtiecorrection.html" class="uri">https://www.harrisgeospatial.com/docs/backgroundgltbowtiecorrection.html</a>, unless the <code>base_georef</code> argument is set to FALSE.</p>
<p>For example the following code:</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="kw">in_file</span>    <span class="op">=</span> <span class="st">"/home/lb/tmp/test/PRS_L1_STD_OFFL_20190825103112_20190825103117_0001.he5"</span>
<span class="kw">out_folder</span> <span class="op">=</span> <span class="st">"/home/lb/tmp/test/"</span>
<span class="kw">out_format</span> <span class="op">=</span> <span class="st">"ENVI"</span>

<span class="co"># Save a full image, prioritizing the SWIR spectrometer and save in ENVI format</span>
<span class="fu"><a href="../reference/pr_convert.html">pr_convert</a></span>(in_file    = <span class="kw">in_file</span>,
               out_folder = <span class="kw">out_folder</span>,
               out_format = <span class="kw">out_format</span>,
               join_priority = <span class="st">"SWIR"</span>,
               FULL   = <span class="fl">TRUE</span>,
               LATLON = <span class="fl">TRUE</span>,
               PAN    = <span class="fl">TRUE</span>,
               CLOUD  = <span class="fl">TRUE</span>)
</pre></div>
<p>accesses the input file and saves both the VNIR and SWIR cubes, as well as a full hyperspectral cube and the PAN, ANGLES and CLOUD datasets <strong>See <a href="reference/pr_convert.html">documentation</a> of the pr_convert() function for info on available arguments</strong>.</p>
<p>The function also saves ancillary data related to wavelengths and fwhms of the different images, and to hour and sun geometry at acquisition in ancillary txt files (See <a href="articles/Output-Format-and-Naming.html">Output format and Naming Conventions</a>.</p>
<div id="associating-acquisition-angles-with-l1-data" class="section level2">
<h2 class="hasAnchor">
<a href="#associating-acquisition-angles-with-l1-data" class="anchor"></a>Associating acquisition angles with L1 data</h2>
<p>PRISMA L1 data unfortunately does not contain information concerning acquisition angles, that is instead available for all L2 datasets. However, if both the L1 and any L2 dataset area available <code>prismaread</code> allows to associate the ANGLES data retrieved from the L2 dataset to the L1 one. To do that, the user has to specify the additional <code>in_L2_file</code> in the call to <code>pr_convert</code>, such as in:</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="kw">in_file</span>    <span class="op">=</span> <span class="st">"/home/lb/tmp/test/PRS_L1_STD_OFFL_20190825103112_20190825103117_0001.he5"</span>
<span class="kw">in_L2_file</span> <span class="op">=</span> <span class="st">"/home/lb/tmp/test/PRS_L2B_STD_OFFL_20190825103112_20190825103117_0001.he5"</span>
<span class="kw">out_folder</span> <span class="op">=</span> <span class="st">"/home/lb/tmp/test/"</span>
<span class="kw">out_format</span> <span class="op">=</span> <span class="st">"ENVI"</span>

<span class="co"># Save a full image, prioritizing the SWIR spectrometer and save in ENVI format</span>
<span class="fu"><a href="../reference/pr_convert.html">pr_convert</a></span>(in_file    = <span class="kw">in_file</span>,
               in_L2_file = <span class="kw">in_L2_file</span>,
               out_folder = <span class="kw">out_folder</span>,
               out_format = <span class="kw">out_format</span>,
               join_priority = <span class="st">"SWIR"</span>,
               FULL   = <span class="fl">TRUE</span>,
               LATLON = <span class="fl">TRUE</span>,
               PAN    = <span class="fl">TRUE</span>,
               CLOUD  = <span class="fl">TRUE</span>,
               ANGLES = <span class="fl">TRUE</span>)
</pre></div>
<p><strong>Note that in this case also the georeferencing information used for the GLT georeferencing is taken from the L2 dataset!</strong></p>
</div>
<div id="importing-only-selected-bands" class="section level2">
<h2 class="hasAnchor">
<a href="#importing-only-selected-bands" class="anchor"></a>Importing only selected bands</h2>
<p>The <code>selbands_vnir</code> e <code>selbands_swir</code> arguments allow to select only a specified subset of PRISMA bands, by specifying an array of required wavelengths. For example:</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="fu"><a href="../reference/pr_convert.html">pr_convert</a></span>(in_file    = <span class="kw">in_file</span>,
               out_folder = <span class="kw">out_folder</span>,
               out_format = <span class="kw">out_format</span>,
               VNIR = <span class="fl">TRUE</span>,
               SwiR = <span class="fl">TRUE</span>,
               selbands_vnir = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">450</span>,<span class="fl">550</span>,<span class="fl">650</span>),
               selbands_swir = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1000</span>,<span class="fl">1330</span>),
               join_priority = <span class="st">"SWIR"</span>,
               FULL   = <span class="fl">TRUE</span>)
</pre></div>
<p>will create a 3-band VNIR cube, a 2-band SWIR and a 5-band FULL dataset, by selecting the original PRISMA bands whit wavelengths closer to the requested ones.</p>
</div>
<div id="creation-of-atcor-files" class="section level2">
<h2 class="hasAnchor">
<a href="#creation-of-atcor-files" class="anchor"></a>Creation of ATCOR files</h2>
<p>When working on L1 data, the <code>pr_convert</code> function also allows automatic creation of text files required to run an atmospheric correction using ATCOR. Those files are saved in the “ATCOR” subfolder of the main output folder.</p>
<p>In “standard” behaviour, only the three “standard” ATCOR files (<code>.wvl</code>, <code>.dat</code> and <code>.cal</code>) are created, within the “ATCOR” subfolder of the main output folder, with the <code>.wvl</code> file containing nominal wavelengths and FWHMs derived from the <code>cw</code> and <code>fwhm</code> attributes of the <em>.he5</em> file.</p>
<p>For example, this code:</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="kw">in_file</span>  <span class="op">=</span> <span class="st">"/home/lb/tmp/test/PRS_L1_STD_OFFL_20190825103112_20190825103117_0001.he5"</span>
<span class="kw">out_folder</span> <span class="op">=</span> <span class="st">"/home/lb/tmp/test/"</span>
<span class="kw">out_format</span> <span class="op">=</span> <span class="st">"ENVI"</span>

<span class="co"># Save a full image, prioritizing the VNIR spectrometer and save in ENVI format</span>
<span class="fu"><a href="../reference/pr_convert.html">pr_convert</a></span>(in_file    = <span class="kw">in_file</span>,
               out_folder   = <span class="kw">out_folder</span>,
               out_format = <span class="kw">out_format</span>,
               join_priority = <span class="st">"VNIR"</span>,
               ATCOR = <span class="fl">TRUE</span>,
               FULL = <span class="fl">TRUE</span>,
               PAN  = <span class="fl">TRUE</span>,
               CLOUD  = <span class="fl">TRUE</span>)
</pre></div>
<p>will create input files for ATCOR useful for correction of the full hyperspectral cube.</p>
<p>The user can however also choose to generate additional ATCOR files, containing data about wavelengths and FWHMs related to different “columns” of the data cube, as derived from the <code>KDP_AUX/Cw_Vnir_Matrix</code>, <code>KDP_AUX/Cw_Swir_Matrix</code>, <code>KDP_AUX/Cw_Fwhm_Matrix</code>, <code>KDP_AUX/Cw_Fwhm_Matrix</code> HDF layers. This could allow running different atmospheric corrections for different columns of the data, potentially allowing compensating “smile” effects on the retrieved surface reflectances. For example, this code:</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="kw">in_file</span>  <span class="op">=</span> <span class="st">"/home/lb/tmp/test/PRS_L1_STD_OFFL_20190825103112_20190825103117_0001.he5"</span>
<span class="kw">out_folder</span> <span class="op">=</span> <span class="st">"/home/lb/pro"</span>
<span class="kw">out_format</span> <span class="op">=</span> <span class="st">"ENVI"</span>

<span class="co"># Save a full image, prioritizing the VNIR spectrometer and save in ENVI format</span>
<span class="fu"><a href="../reference/pr_convert.html">pr_convert</a></span>(in_file    = <span class="kw">in_file</span>,
               out_folder   = <span class="kw">out_folder</span>,
               out_format = <span class="kw">out_format</span>,
               join_priority = <span class="st">"SWIR"</span>,
               ATCOR = <span class="fl">TRUE</span>,
               ATCOR_wls = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">200</span>,<span class="fl">800</span>),
               FULL = <span class="fl">TRUE</span>,
               PAN  = <span class="fl">TRUE</span>,
               CLOUD  = <span class="fl">TRUE</span>)
</pre></div>
</div>
<div id="importing-l2-data" class="section level2">
<h2 class="hasAnchor">
<a href="#importing-l2-data" class="anchor"></a>Importing L2 data</h2>
<p>The function to be used to import PRISMA L2(B,C or D) data is <code>pr_convert</code>. It takes as input the full path of a PRISMA L2 hdf5 image, an output folder name and format, and a series of switches allowing to decide which hyperspectral cubes and ancillary datasets should be crated.</p>
<p>In particular:</p>
<ul>
<li>the <code>VNIR</code> and <code>SWIR</code> logical arguments allow to decide if importing the VNIR and SWIR hyperspectral cubes;</li>
<li>the <code>FULL</code> logical argument <code>FULL</code> argument allows deciding if a complete VNIR+SWIR cube has to be created alongside the “single” VNIR and SWIR ones. In that case, the ‘join_priority’ keyword is used to decide if keeping bands from the “VNIR” or the “SWIR” data cube in the wavelength were they overlap.</li>
<li>the <code>PAN</code>, <code>LATLON</code> and <code>ANGLES</code> allow to decide which of the corresponding ancillary datasets should be created (see the PRISMA manual for additional info)</li>
</ul>
<p>If working with <strong>L2B</strong> or <strong>L2C</strong> data, a “base” georeferencing in Lat/Lon WGS-84 based on the “GLT and Bowtie Correction” technique used in ENVI, and described in <a href="https://www.harrisgeospatial.com/docs/backgroundgltbowtiecorrection.html" class="uri">https://www.harrisgeospatial.com/docs/backgroundgltbowtiecorrection.html</a>, unless the <code>base_georef</code> argument is set to FALSE.</p>
<p>If working with <strong>L2D</strong>, the output datasets are already georeferenced (usually in UTM projection), although accuracy of geolocation should be checked.</p>
<p>For example the following code:</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="kw">in_file</span>    <span class="op">=</span> <span class="st">"/home/lb/tmp/test/PRS_L2B_STD_20190825103112_20190825103117_0001.he5"</span>
<span class="kw">out_folder</span> <span class="op">=</span> <span class="st">"/home/lb/tmp/test/"</span>
<span class="kw">out_format</span> <span class="op">=</span> <span class="st">"ENVI"</span>

<span class="co"># Save a full image, prioritizing the VNIR spectrometer and save in ENVI format</span>
<span class="fu"><a href="../reference/pr_convert.html">pr_convert</a></span>(in_file    = <span class="kw">in_file</span>,
           out_folder = <span class="kw">out_folder</span>,
           out_format = <span class="kw">out_format</span>,
           VNIR       = <span class="fl">TRUE</span>,
           SWIR       = <span class="fl">FALSE</span>,
           FULL       = <span class="fl">FALSE</span>,
           LATLON     = <span class="fl">TRUE</span>,
           PAN        = <span class="fl">TRUE</span>,
           ANGLES     = <span class="fl">TRUE</span>)
</pre></div>
<p>The following code accesses the input file and saves the VNIR and SWIR cubes, as well as a full hyperspectral cube and the ANGLES and LATLON datasets <strong>See <a href="reference/pr_convert.html">documentation</a> of the pr_convert() function for info on available arguments</strong>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="kw">in_file</span>    <span class="op">=</span> <span class="st">"/home/lb/tmp/test/PRS_L2D_STD_20190825103112_20190825103117_0001.he5"</span>
<span class="kw">out_folder</span> <span class="op">=</span> <span class="st">"/home/lb/tmp/test/"</span>
<span class="kw">out_format</span> <span class="op">=</span> <span class="st">"ENVI"</span>

<span class="co"># Save a full image, prioritizing the VNIR spectrometer and save in EVI format</span>
<span class="fu"><a href="../reference/pr_convert.html">pr_convert</a></span>(in_file    = <span class="kw">in_file</span>,
           out_folder = <span class="kw">out_folder</span>,
           out_format = <span class="kw">out_format</span>,
           VNIR       = <span class="fl">TRUE</span>,
           SWIR       = <span class="fl">TRUE</span>,
           FULL       = <span class="fl">TRUE</span>,
           LATLON     = <span class="fl">TRUE</span>,
           ANGLES     = <span class="fl">TRUE</span>)
</pre></div>
<p>The function also saves ancillary data related to wavelengths and fwhms of the different images, and to hour and sun geometry at acquisition in ancillary txt files (See <a href="articles/Output-Format-and-Naming.html">Output format and Naming Conventions</a>.</p>
</div>
<div id="importing-only-selected-bands-1" class="section level2">
<h2 class="hasAnchor">
<a href="#importing-only-selected-bands-1" class="anchor"></a>Importing only selected bands</h2>
<p>The <code>selbands_vnir</code> e <code>selbands_swir</code> arguments allow to select only a specified subset of PRISMA bands, by specifying an array of required wavelengths. For example:</p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="fu"><a href="../reference/pr_convert.html">pr_convert</a></span>(in_file       = <span class="kw">in_file</span>,
           out_folder    = <span class="kw">out_folder</span>,
           out_format    = <span class="kw">out_format</span>,
           VNIR          = <span class="fl">TRUE</span>,
           SWIR          = <span class="fl">TRUE</span>,
           selbands_vnir = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">450</span>,<span class="fl">550</span>,<span class="fl">650</span>),
           selbands_swir = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1000</span>,<span class="fl">1330</span>),
           join_priority = <span class="st">"SWIR"</span>,
           FULL          = <span class="fl">TRUE</span>)
</pre></div>
<p>will create a 3-band VNIR cube, a 2-band SWIR and a 5-band FULL dataset, by selecting the original PRISMA bands with wavelengths closer to the requested ones.</p>
</div>
</div>
<div id="computing-spectral-indexes" class="section level1">
<h1 class="hasAnchor">
<a href="#computing-spectral-indexes" class="anchor"></a>Computing Spectral Indexes</h1>
<p><code>prismaread</code> allows to automatically compute spectral indexes starting from either an original PRISMA hdf image, or from an hyperspectral cube already processed with <code>convert prisma</code>.</p>
<div id="computing-spectral-indexes-from-a-predefined-list" class="section level2">
<h2 class="hasAnchor">
<a href="#computing-spectral-indexes-from-a-predefined-list" class="anchor"></a>Computing spectral indexes from a predefined list</h2>
<p>Spectral Indexes to be computed can be selected from a list of predefined ones. To do so, either specify a vector of desired indexes as the <code>indexes</code> argument of <code>pr_convert</code> to compute them directly from the hdf prisma data:</p>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="kw">in_file</span> <span class="op">&lt;-</span> <span class="st">"D:/prismaread/L2D/PRS_L2D_STD_20190616102249_20190616102253_0001.he5"</span>
<span class="fu"><a href="../reference/pr_convert.html">pr_convert</a></span>(<span class="kw">in_file</span>,
           out_format = <span class="st">"ENVI"</span>,
           out_folder = <span class="st">"D:/prismaread/L2D/testL2D/ENVI"</span>,
           indexes    = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"GI"</span>, <span class="st">"MTCI"</span>))
</pre></div>
<p>, or use function <code>pr_compute_indexes</code> to compute them starting from an hyperspectral cube already processed:</p>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="kw">in_file</span>  <span class="op">&lt;-</span> <span class="st">"PRS_L2D_STD_20190616102249_20190616102253_0001_HCO_FULL.envi"</span>
<span class="kw">out_file</span> <span class="op">&lt;-</span> <span class="st">"D:/prismaread/L2D/testL2D/ENVI/outfile_indexes"</span>
<span class="fu"><a href="../reference/pr_compute_indexes.html">pr_compute_indexes</a></span>(<span class="kw">in_file</span>,
                       out_file = <span class="kw">out_file</span>,
                       out_format = <span class="st">"ENVI"</span>,
                       indexes = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"GI"</span>, <span class="st">"MTCI"</span>))
</pre></div>
<p>Output file names are created by adding a suffix corresponding to the indexes names to the base output filename. In addition, an ancillary file containing the formulas used to compute each index is saved (extension = <em>.formulas</em>) for reference. the file shows the formulas used, giving reference to the true wavelengths of the PRISMA bands used in the computation.</p>
<p>The list of available indexes, shown below, was derived from the list of spectral indexes available in package <a href="https://cran.r-project.org/web/packages/hsdar/hsdar.pdf"><code>hsdar</code></a>, as well as from the list reported <a href="https://cubert-gmbh.com/applications/vegetation-indices/">HERE</a>.</p>
<div id="htmlwidget-fca584d89ade67ebe290" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-fca584d89ade67ebe290">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130"],["ARI","BGI","BRI","CAI","CI","CI2","CRI","CRI1","CRI2","CRI2","CRI3","CRI4","CSI","CSI2","CSI3","CSI4","CSI5","CUR","Datt","Datt2","Datt4","Datt5","Datt6","Datt7","Datt8","DD","DDn","DSWI","DWSI1","DWSI2","DWSI3","DWSI4","DWSI5","EVI","EVI2","GI","Gitelson","Gitelson2","GM3","GMI1","GMI2","gNDVI","hNDVI","LCI","LIC1","LIC2","LIC3","LWVI1","LWVI2","Maccioni","MCARI","MCARI705","MCARI/OSAVI","MCARI1","MCARI2","MCARI2/OSAVI2","MLO","mND705","mNDVI","MPRI","MSAVI","MSI","mSR","mSR2","mSR705","MTCI","MTVI","MTVI2","NDLI","NDNI","NDVI","NDVI_zarco","NDVI_apar","NDVI_gandia","NDVI_git","NDVI_green2","NDVI_hab","NPCI","NPCI","NPQI","OSAVI","OSAVI2","PRI","PRI*CI2","PRI_norm","PSND","PSRI","PSSR","PSSRa","PSSRb","PSSRc","PWI","RDVI","REIP1","REP","RGI","SAVI","SIPI","SPVI","SR","SR_chla","SR_chlb","SR_chlb2","SR_chltot","SR_chl","SR4","SR5","SR6","SR6","SR7","SR705","SRPI","SRWI","SRWI","SWIR_FI","SWIR_LI","SWIR_SI","SWIR_VI","TCARI","TCARI over OSAVI","TCARI2","TCARI2/OSAVI2","TGI","TVI","VOG1","VOG2","VOG3","ZTM","myindex","009066L"],["Anthocyanin Reflectance Index","Blue Green Pigment Index","Blue Red Pigment Index","Cellulose Absorption Index","Curvative Index","","Carotenoid Reflectance","","Carotenoid Reflectance","","","","Carter Stress Index","Carter Stress Index","Carter Stress Index","Carter Stress Index","Carter Stress Index","Curvature Index","","","","","","","","","","Desease Water Stress Index","Desease Water Stress Index","Desease Water Stress Index","Desease Water Stress Index","Desease Water Stress Index","Desease Water Stress Index","","","Greenness Index","","","","Gitelson &amp; Merzlyak Index","Gitelson &amp; Merzlyak Index","Green NDVI","hyperspectral NDVI","Leaf Chlorophyll Index","Lichtenthaler Index","Lichtenthaler Index","Lichtenthaler Index","Leaf Water Vegetation Index","Leaf Water Vegetation Index ","","Modified Chlorophyll Absorption in Reflectance Index","","","Modified Chlorophyll Absorption in Reflectance Index","Modified Chlorophyll Absorption in Reflectance Index","","M Locherer Chlorophyll","","","","","Moisture Stress Index","","","","","Modified Triangular Vegetation Index","Modified Triangular Vegetation Index","Normalized Difference Lignin Index","Normalized Difference Nitrogen Index","Normalized Difference Vegetation Index","Normalized Difference Vegetation Index","Normalized Difference Vegetation Index","","","","Normalized Difference Vegetation Index","Normalized total Pigment to Chlorphyll Index","Normalized Pigment Chlorophyll Index","Normalized Phaeophytinization Index","Optimized Soil Adjusted Vegetation Index","Optimized Soil Adjusted Vegetation Index","Photochemical Reflectance Index","","","Pigment Specific Normalized Difference","","Pigment Specific Simple Ratio","Pigment Specific Simple Ratio for Chl a","Pigment Specific Simple Ratio for Chl b","Pigment Specific Simple Ratio for Carotenoids","Plant Water Index","Renormalized Difference Vegetation Index","Red Edge Inflection Point","Red Edge Point","Red-Green Pigment Index","Soil Adjusted Vegetation Index","Structural Independent Pigment Index","Spectral Polygon Vegetation Index","Simple Ratio Index","Simple Ratio","Simple Ratio","Simple Ratio","Simple Ratio","Simple Ratio","","","","","","Simple Ratio at 705 Index","Simple Ratio Pigment Index","Simple Ratio Water Index","","","","","Shortwave Infrared Green Vegetation Index","Transformed Chlorophyll Absorption in Reflectance Index","Ratio","","","","Triangular Vegetation Index","Vogelmann Index","Vogelmann Index","Vogelmann Index","Zarco-Tejada &amp; Miller","My custom Index","My custom Index"],["1 / R550 - 1 / R700","R450 / R550","R450 / R690","0.5*(R2015 + R2195) - R2106","(R675 * R690) / R683 ^ 2","R760 / R700 - 1","1 / R510 - 1 / R550","1/R515 - 1/R550","1 / R510 - 1 / R700","1/R515 - 1/R770","(1/R515 - 1/R550) * R770","(1/R515 - 1/R700) * R770","R695 / R420","R695 / R760","R605 / R760","R710 / R760","R550","R675 * R550 / R2683","(R850 - R710)/(R850 - R680)","R850 / R710","R672/(R550 * R708)","R672 / R550","R860 / (R550 * R708)","(R860 - R2218) / (R860 - R1928)","(R860 - R1788) / (R860 - R1928)","(R749 - R720) - (R701 - R672)","2 * (R710 - R660 - R760)","(R802 - R547) / (R1657 + R682)","R800 / R1660","R1660 / R550","R1660 / R680","R550 / R680","(R800 + R550) / (R1660 + R680)","2.5 * ((R800 - R670)/  (R800 - (6 * R670) - (7.5 * R475) + 1))"," 2.4 * (R800 - R670) / (R800 + R670 + 1)","R554 / R677","1 / R700","(R750 - R800/R695 - R740) - 1","R752 / R690","R750 / R550","R750 / R700","(R750 - R550) / (R750 + R550)","(R827 - R668) / (R827 + R668)","(R850 - R710) / (R850 + R680)","(R800 - R680) / (R800 + R680)","R440 / R690","R440 / R740","(R1094 - R983) / (R1094 + R983)","(R1094 - R1205) / (R1094 + R1205)","(R780 - R710)/(R780 - R680)","((R700-R670) - 0.2*(R700 - R550))*(R700 / R670)","((R750 - R705) - 0.2 * (R750 -R550)) * (R750/R705)","(((R700-R670) - 0.2*(R700 - R550))*(R700 / R670)) / ((1 + 0.16) * (R800 - R670) / (R800 + R670 + 0.16))","MCARI1=1.2*(2.5*(R800-R670)-1.3*(R800-R550))","MCARI1=1.5*(2.5*(R800-R670)-1.3*(R800-R550)) / ((2*R800+1) ^2-(6*R800-5*R680^0.5)-0.5) ^ 0.5","(((R700-R670) - 0.2*(R700 - R550))*(R700 / R670)) / ((1 + 0.16) * (R750 - R705) / (R750 + R705 + 0.16))","R531 / R645","(R750 - R705) / (R750 + R705 - 2 * R445)","(R800 - R680) / (R800 + R680 - 2 * R445)","(R515 - R530)/(R515 + R530)","0.5 * (2 * R800 + 1) - ((2 * R800 + 1) ^2 - 8 * (R800 - R670)) ^ 0.5","R1600/R817","(R800 - R445) / (R680 - R445)","(R750 / R705) - (1 / (R750 / R705 + 1) ^ 0.5)","(R750 - R445) / (R705 - R445)","(R754 - R709) / (R709 - R681)","1.2 * (1.2 * (R800 - R550) - 2.5 * (R670 - R550))","1.5*(1.2*(R800-R550)-2.5*(R670-R550)) / ((2*R800+1) ^2 - (6*R800 - 5*(R670 ^ 0.5)) -0.5) ^ 0.5","(log(1/R1754) - log(1/R1680))/  (log(1/R1754) + log(1/R1680))","(log(1/R1510) - log(1/R1680)) / (log(1/R1510) + log(1/R1680))","(R800 - R680) / (R800 + R680)","(R774 -R677) / (R774 + R677)","(R900 - R680) / (R900 + R680)","(R682 - R553) / (R682 + R553)","(R750 - R705) /(R750 + R705)","(R800 - R550) / (R800 + R550)","(R800-R670) / (R800+R670)","(R680 - R430) / (R680+R430)","(R680 - R430)/(R680 + R430)","(R415 - R435) / (R415 + R435)","(1 + 0.16) * (R800 - R670) / (R800 + R670 + 0.16)","(1 + 0.16) * (R750 - R705) / (R750 + R705 + 0.16)","(R531 - R570) / (R531 + R570)","(R531 - R570)/(R531 + R570) * (R760/R700 - 1)","(R531 - R570) / (R531 + R570) * (-1)/(((R800 - R670) / (R800 + R670) ^ 0.5) * R700/R670)","(R800 - R470) / (R800 - R470)","(R678 - R500) / R750","R800 / R635","R800 / R675","R800 / R650","R800 / R500","R900 / R970","(R800 - R670) / (R800 + R670) ^ 0.5","(700 + 740 / 700)*((R780 / R670) - R780) / (R740 + R700)","700 + 40*((R670+R780)^2 - R700) / (R740 - R700)","R690 / R550","(1 + 0.5) * (R800 - R670)/(R800 + R670 + 0.5)","(R445 - R800) / (R670-R800)","0.4 * 3.7 * (R800 - R670) - 1.2* abs(R530 - R670)","R800 / R680","R675 / R700","R675 / (R650*R700)","R672 / R708","R760 / R500","R672 / (R550*R700)","R700 / R670","R675 / R700","R746 / R513","R750 / R710","R440 / R690","R750 / R705","R430 / R680","R858 / R1240","R850 / R1240","R2133 ^ 2 / (R2225 * R2209 ^ 3)","3.87 * (R2210 - R2090) - 27.51 * (R2280 - R2090) - 0.2","0.64","37.72 * (R2210 - R2090) + 26.27 * (R2280 - R2090) + 0.57","3 * ((R700 - R670) - 0.2 * (R700 - R550) * (R700/R670))","(3 * ((R700 - R670) - 0.2 * (R700 - R550) * (R700/R670))) / ((1 + 0.16) * (R800 - R670) / (R800 + R670 + 0.16))","3 * ((R750 - R705) - 0.2 * (R750 - R550)*(R750/R705))","(3 * ((R750 - R705) - 0.2 * (R750 - R550)*(R750/R705))) / ((1 + 0.16) * (R750 - R705) / (R750 + R705 + 0.16))","0","0.5 * (120 * (R750 - R550) - 200 * (R670 - R550))","R740/R720","(R734 - R747)/(R715 + R726)","(R734 - R747)/(R715 + R720)","R750 / R710","R600 / R700","R600 / R700"],["Carotenoid content","Dry Matter / Pigment","Dry Matter / Pigment","Dry Matter / Cellulose Absorption","","","Carotenoid content","","Carotenoid content","","","","Chlorophyll","Chlorophyll","","","","Flourescence","","","","","","","","","","Water Content","Water Content","Water Content","Water Content","Water Content","Water Content","","","Chlorophyll","","","","Chlorophyll","Chlorophyll","Chlorophyll","Structure","Chlorphyll content","Flourescence","Flourescence","Flourescence","Water Content","Water Content","","Chlorophyll","","","Structure","Structure","","Chlorophyll","","","","","Water Content","","","","","Structure","Structure","Dry Matter / Lignin","Dry Matter / Nitrogen","Structure","Structure","Structure","","","","Structure","Senescence","Dry Matter / Pigment","Chlorophyll","Structure","","Chlorophyll","","","","","","Chlorophyll a","Chlorophyll b","Carotenoid content","Water Content","Structure","Chlorophyll","Chlorophyll","Dry Matter / Pigment","Structure","Carotenoids: chlorophyll a ratio","Structure","Structure","Chlorophyll (Chl a)","Chlorophyll (Chl b)","Chlorophyll (Chl b)","Chlorophyll (total)","Chlorophyll","","Chlorophyll","PAR","","","Chlorophyll","Dry Matter / Pigment","Water Content","","","","","Dry Matter","Chlorophyll","Chlorophyll","","","","Chlorophyll","Chlorophyll","Chlorophyll","Chlorophyll","Chlorophyll",null,null],["Gitelson et al. (2002)","Zarco-Tejada et al. (2005)","Zarco-Tejada et al. (2005)","Nagler et al. (2003)","Zarco-Tejada et al. (2003)","Gitelson et al. (2003)","Gitelson et al. (2002)","Gitelson et al. (2003)","Gitelson et al. (2002)","Gitelson et al. (2003)","Gitelson et al. (2003)","Gitelson et al. (2003)","Carter (1994)","Carter (1994)","Carter (1994)","Carter (1994)","Carter (1994)","Zarco-Tejada et al. (2000)","Datt (1999b)","Datt (1999b)","Datt (1999b)","Datt (1999b)","Datt (1999b)","Datt (1999b)","Datt (1999b)","le Maire et al. (2004)","le Maire et al. (2004)","Galv&lt;e3&gt;o et al. (2005)","Apan et al. (2004)","Apan et al. (2004)","Apan et al. (2004)","Apan et al. (2004)","Apan et al. (2004)","Huete et al. (1997)","Jiang (2008)","Zarco-Tejada et al. (2005)","Gitelson et al. (1999)","Gitelson et al. (2003)","Gitelson and Merzlyak (1997)","Gitelson and Merzlyak (1997)","Gitelson and Merzlyak (1997)","Datt (1998)","Oppelt (2002)","Datt (1999)","Lichtenthaler et al. (1996)","Lichtenthaler et al. (1996)","Lichtenthaler et al. (1996)","Galv&lt;e3&gt;o et al. (2005)","Galv&lt;e3&gt;o et al. (2005","Maccioni et al. (2001)","Daughtry et al. (2000)","Wu et al. (2008)","Daughtry et al. (2000)","Haboudane et al. (2004)","Haboudane et al. (2004)","Wu et al. (2008)","unpublished","Sims and Gamon (2002)","Sims and Gamon (2002)","","Qi et al. (1994)","Hunt et al. (1989)","Sims and Gamon (2002)","Chen (1996)","Sims and Gamon (2002)","","Haboudane et al. (2004)","Haboudane et al. (2004)","Serrano et al. (2002)","Serrano et al. (2002)","Datt (1998)","Zarco-Tejada (1999)","Aparicio et al. (2002)","Gandia et al. (2004)","Gitelson and Merzlyak (1994)","Gitelson et al. (2003)","Haboudane (2004)","Penuelas (1994)","Penuelas et al. (1994)","Barnes (1992)","Rondeaux et al. (1996)","Wu et al. (2008)","Gamon et al. (1992)","Garrity et al. (2011)","Zarco-Tejada et al. (2013)","Blackburn (1998)","Merzlyak et al. (1999)","Blackburn (1998)","Blackburn (1998)","Blackburn (1998)","Blackburn (1998)","Penuelas et al. (1997)","Rougean and Breon (1995)","Guyot et al. (1988)","Dawson and Curran (1998)","Zarco-Tejada et al. (2005)","Huete (1988)","Penuelas and Filella (1998)","Vincini et al. (2006)","Jordan (1969); Rouse et al. (1979)","Datt (1998)","Datt (1998)","Datt (1998)","Datt (1998)","Datt (1998)","McMurtrey et al. (1994)","Chappelle et al. (1992)","Chappelle et al. (1992)","Zarco-Tejada and Miller (1999)","Lichtenthaler et al. (1996)","Sims and Gamon (2002)","Penuelas et al. (1995)","Zarco-Tejada et al. (2003)","Zarco-Tejada et al. (2003)","Levin et al. (2007)","Lobell et al. (2001)","Lobell et al. (2001) ","Lobell et al. (2001)","Haboudane et al. (2002)","-","Wu et al. (2008)","Wu et al. (2008)","Hunt et al. (2013)","Broge and Leblanc(2000)","Vogelmann (1993)","Vogelmann (1993)","Vogelmann (1993)","Zarco-Tejada et al. (2001)","Me (2020)","Me (2020)"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Name<\/th>\n      <th>Description<\/th>\n      <th>Formula<\/th>\n      <th>Sensitivity<\/th>\n      <th>Reference<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"order":[],"autoWidth":false,"orderClasses":false,"columnDefs":[{"orderable":false,"targets":0}]}},"evals":[],"jsHooks":[]}</script><p><strong>NOTE</strong> Although a check was done on indexes formulas, we do not guarantee that all of them are correct. Please check the formulas in the table to be sure!</p>
<p><strong>IMPORTANT NOTE</strong></p>
<p>Computation of spectral indexes can be done alongside extraction of spectral cubes/ancillary info. For example, this commands:</p>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="kw">in_file</span>  <span class="op">&lt;-</span> <span class="st">"PRS_L2D_STD_20190616102249_20190616102253_0001_HCO_FULL.envi"</span>
<span class="kw">out_file</span> <span class="op">&lt;-</span> <span class="st">"D:/prismaread/L2D/testL2D/ENVI/outfile_indexes"</span>
<span class="fu"><a href="../reference/pr_compute_indexes.html">pr_compute_indexes</a></span>(<span class="kw">in_file</span>,
                       out_file = <span class="kw">out_file</span>,
                       VNIR = <span class="fl">TRUE</span>, LATLON = <span class="fl">TRUE</span>, ANGLES = <span class="fl">TRUE</span>,
                       out_format = <span class="st">"ENVI"</span>,
                       indexes = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"GI"</span>, <span class="st">"MTCI"</span>))
</pre></div>
<p>will save in output the VNIR cube, LATLON and ANGLES datasets and compute and save images relative to the “GI” and “MTCI” indexes.</p>
<div id="adding-a-new-index-to-the-list" class="section level3">
<h3 class="hasAnchor">
<a href="#adding-a-new-index-to-the-list" class="anchor"></a>Adding a new index to the list</h3>
<p>Additional spectral indexes can be added to the aforementioned list using function <code><a href="../reference/pr_addindex.html">pr_addindex()</a></code>, as in the following example</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">pr_addindex</span>(<span class="dt">Name =</span> <span class="st">"myindex"</span>, <span class="dt">Formula =</span> <span class="st">"R600 / R700"</span>, </span>
<span id="cb13-2"><a href="#cb13-2"></a>            <span class="dt">Description =</span> <span class="st">"My custom Index"</span>, </span>
<span id="cb13-3"><a href="#cb13-3"></a>            <span class="dt">Reference =</span> <span class="st">"Me (2020)"</span></span></code></pre></div>
</div>
</div>
<div id="computing-custom-spectral-indexes" class="section level2">
<h2 class="hasAnchor">
<a href="#computing-custom-spectral-indexes" class="anchor"></a>Computing custom spectral indexes</h2>
<p>Custom spectral indexes can also be computed on the fly by specifying the <code>cust_indexes</code> argument, as a <strong>named list</strong>, such as in:</p>
<div class="sourceCode" id="cb14"><pre class="downlit">
<span class="fu"><a href="../reference/pr_convert.html">pr_convert</a></span>(<span class="kw">in_file</span>,
               out_format = <span class="st">"ENVI"</span>,
               out_folder = <span class="st">"D:/prismaread/L2D/testL2D/ENVI"</span>,
               indexes = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"GI"</span>, <span class="st">"MTCI"</span>),
               cust_indexes = <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(myindex1 = <span class="st">"R500 / R600"</span>,
                                   myindex2 = <span class="st">"(R800 - R680) / (R800 + R680)"</span>))
</pre></div>
</div>
</div>
<div id="output-format-and-naming-conventions" class="section level1">
<h1 class="hasAnchor">
<a href="#output-format-and-naming-conventions" class="anchor"></a>Output Format and naming Conventions</h1>
<div id="format-of-output-rasters" class="section level3">
<h3 class="hasAnchor">
<a href="#format-of-output-rasters" class="anchor"></a>Format of output rasters</h3>
<ul>
<li>Outputs are provided as rasters in <strong>ENVI</strong> or <strong>GEOTIFF</strong> format according to user’s choice in the <code>output_format</code> argument of <code>pr_convert</code>.</li>
</ul>
</div>
<div id="naming-conventions" class="section level3">
<h3 class="hasAnchor">
<a href="#naming-conventions" class="anchor"></a>Naming conventions</h3>
<ul>
<li>Filenames are built starting from the output folder name provided by the user, by adding appropriate suffixes. If <code>out_basefile</code> is not specified (or set to <code>auto</code>, the Default), output file names are created based on the filename of the hdf5 input. For example, if in_file is “PRS_L1_STD_OFFL_20190825103112_20190825103117_0001.he5”, the output file for the VNIR cube will be <code>PRS_L1_STD_OFFL_20190825103112_20190825103117_0001_HCO_VNIR.envi</code> (or .tif), that for SWIR will be <code>PRS_L1_STD_OFFL_20190825103112_20190825103117_0001_HCO_SWIR.envi</code> ), etcetera.</li>
</ul>
<p>If <code>out_basefile</code> is specified, the filenames are created substituting the specified string. For example, if out_basefile is “myprisma”, the output file for the VNIR cube will be <code>myprisma_HCO_VNIR.envi</code> (or .tif), that for SWIR will be <code>myprisma_HCO_SWIR.envi</code> ), etcetera.</p>
</div>
<div id="measure-units" class="section level3">
<h3 class="hasAnchor">
<a href="#measure-units" class="anchor"></a>Measure Units</h3>
<ul>
<li>
<p>Measure units of the output hyperspectral data are as follows:</p>
<table class="table">
<thead><tr class="header">
<th align="center">LEVEL</th>
<th align="center">Variable</th>
<th align="center">Measure Units</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">L1</td>
<td align="center">Radiance</td>
<td align="center">W / m^2 * sr * um</td>
</tr>
<tr class="even">
<td align="center">L2B</td>
<td align="center">Radiance</td>
<td align="center">W / m^2 * sr * um</td>
</tr>
<tr class="odd">
<td align="center">L2C</td>
<td align="center">Reflectance</td>
<td align="center">unitless (ratio)</td>
</tr>
<tr class="even">
<td align="center">L2D</td>
<td align="center">Reflectance</td>
<td align="center">unitless (ratio)</td>
</tr>
</tbody>
</table>
</li>
</ul>
</div>
<div id="ancillary-info" class="section level3">
<h3 class="hasAnchor">
<a href="#ancillary-info" class="anchor"></a>Ancillary info</h3>
<ul>
<li><p>If output format is “ENVI”, the wavelengths of the different bands for the hyperspectral cubes are properly written in the appropriate header (.hdr) file.</p></li>
<li><p>Irrespective from output format, info about wavelengths and fwhms of the hyperspectral cubes are saved in appropriate txt files. For example, if the output file is <code>D:/myoutfolder/myoutfil_HCO_VNIR.envi</code>, info about the wavelengths is saved in <code>D:/myoutfolder/myoutfil_HCO_VNIR.wvl</code></p></li>
<li><p>Info about acquisition date and angles is saved in a dedicated txt file. For example, if output file is <code>D:/myoutfolder/myoutfil_VNIR.envi</code>, info about the angles is saved in <code>D:/myoutfolder/myoutfil_HCO_VNIR.ang</code></p></li>
</ul>
</div>
</div>
<div id="extracting-data-over-vector-features" class="section level1">
<h1 class="hasAnchor">
<a href="#extracting-data-over-vector-features" class="anchor"></a>Extracting Data over Vector Features</h1>
<p><code>prismaread</code> provides a very efficient function based on package <code>exactextractr</code>(<a href="https://github.com/isciences/exactextractr" class="uri">https://github.com/isciences/exactextractr</a>) for extracting and summarizing data from the converted hyperspectral cubes over features of vector spatial files. The function allows to compute several statistics, as well as extracting all pixel values, and to save them to RData, CSV or EXCEL files (<strong>See <a href="reference/pr_extract_spectra.html">documentation</a> of the prisma_extract_spectra() function for info on available arguments</strong>).</p>
<p>For example, starting from a VNIR Cube obtained with <code>pr_convert</code> and a vector polygon file:</p>
<div class="sourceCode" id="cb15"><pre class="downlit">
  <span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://irea-cnr-mi.github.io/prismaread">prismaread</a></span>)
  <span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="http://ggplot2.tidyverse.org">ggplot2</a></span>)

  <span class="kw">in_file</span> <span class="op">&lt;-</span> <span class="st">"D:/prismaread/L2D/testL2D_HCO_VNIR.envi"</span>
  <span class="kw">in_vect</span> <span class="op">&lt;-</span> <span class="st">"D:/prismaread/test/testpoints_l2d_polys.gpkg"</span>

  <span class="co"># extract base statistics, in "long" format</span>
  <span class="kw">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pr_extract_spectra.html">pr_extract_spectra</a></span>(<span class="kw">in_file</span>, <span class="kw">in_vect</span>, id_field = <span class="st">"ID"</span>)
  <span class="kw">test</span>
  <span class="co"># plot results using ggplot</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw">test</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x = <span class="kw">wvl</span>, y = <span class="kw">mean</span>)) <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(color = <span class="kw">ID</span>, group = <span class="kw">ID</span>)) <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="op">~</span><span class="kw">ID</span>) <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_light</a></span>()

  <span class="co"># extract base statistics ands save results as excel file, in "wide" format</span>
  <span class="kw">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pr_extract_spectra.html">pr_extract_spectra</a></span>(<span class="kw">in_file</span>, <span class="kw">in_vect</span>, out_file = <span class="st">"D:/Temp/test1.xlsx"</span>,
                                 stats_format = <span class="st">"wide"</span>, id_field = <span class="st">"id"</span>)
  <span class="kw">test</span>

  <span class="co"># extract custom statistics</span>
  <span class="kw">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pr_extract_spectra.html">pr_extract_spectra</a></span>(<span class="kw">in_file</span>, <span class="kw">in_vect</span>,
                                 selstats = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"mean"</span>, <span class="st">"coeffvar"</span>, <span class="st">"stdev"</span>, <span class="st">"min"</span>, <span class="st">"max"</span>),
                                 id_field = <span class="st">"id"</span>)

  <span class="kw">test</span>

  <span class="co"># plot results using ggplot</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw">test</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x = <span class="kw">wvl</span>)) <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(y = <span class="kw">mean</span>, color = <span class="kw">ID</span>, group = <span class="kw">ID</span>)) <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(y = <span class="kw">mean</span> <span class="op">+</span> <span class="kw">stdev</span>, group = <span class="kw">ID</span>), color = <span class="st">"grey75"</span>) <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(y = <span class="kw">mean</span> <span class="op">-</span> <span class="kw">stdev</span>, group = <span class="kw">ID</span>), color = <span class="st">"grey75"</span>) <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="op">~</span><span class="kw">ID</span>) <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_light</a></span>()


  <span class="co"># extract custom statistics and quantiles</span>
  <span class="kw">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pr_extract_spectra.html">pr_extract_spectra</a></span>(<span class="kw">in_file</span>, <span class="kw">in_vect</span>, quantiles = <span class="fl">TRUE</span>,
                                 selstats = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"mean"</span>, <span class="st">"stdev"</span>),
                                 id_field = <span class="st">"id"</span>)
  <span class="kw">test</span>


  <span class="co"># extract also all pixels</span>
  <span class="kw">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pr_extract_spectra.html">pr_extract_spectra</a></span>(<span class="kw">in_file</span>, <span class="kw">in_vect</span>, allpix = <span class="fl">TRUE</span>,
                                 selstats = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"mean"</span>, <span class="st">"stdev"</span>),
                                 id_field = <span class="st">"id"</span>)


  <span class="co"># stats are saved in the "stats" slot of the output</span>
  <span class="kw">test</span><span class="op">$</span><span class="kw">stats</span>

  <span class="co"># pixel values are saved in the "allpix" slot of the output</span>
  <span class="kw">test</span><span class="op">$</span><span class="kw">allpix</span>

  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw">test</span><span class="op">$</span><span class="kw">allpix</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x = <span class="kw">wvl</span>)) <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(y = <span class="kw">value</span>, group = <span class="kw">pixel</span>, color = <span class="kw">ID</span>), lwd = <span class="fl">0.01</span>)  <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="op">~</span><span class="kw">ID</span>) <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_light</a></span>()
</pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Lorenzo Busetto, Luigi Ranghetti.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>




  </body>
</html>
